{% extends "basepage.html" %}
{% block title %}Log Sales Withdrawal/Deposit{% endblock %}
{% block content %}
    <h1>Sales Logging</h1>
    <form method="post" action="{{ url_for('sale') }}">
        Pre Tax Amount<br>
        <input name="preTaxAmount" title="preTaxAmount" type="number"><br>
        Tax Amount<br>
        <input name="taxAmount" title="taxAmount" type="number"><br>
        Transaction Type<br>
        <select name="transactionType" title="transactionType">
            <option value="withdrawal">Withdrawal</option>
            <option value="deposit">Deposit</option>
        </select><br>
        Sale ID<br>
        <input name="salesID" title="salesID" type="number"><br>
        <input type="submit" value="submit">
    </form>
{% endblock %}
{% block react %}
    const initialState = {
        preTaxAmount : null,
        taxAmount : null,
        transactionType : '',
        salesID : null
    };

    class SaleForm extends React.Component {
        constructor(props) {
            super(props)
            this.handleChange = this.handleChange.bind(this);
            this.handleSubmit = this.handleSubmit.bind(this);
            this.state = initialState;
        }
        handleChange(event) {
            this.setState({[event.target.name]: isNaN(event.target.value) ? event.target.value : Number(event.target.value)});
        }
        handleSubmit(event) {
            event.preventDefault();
            fetch('{{ url_for('sale') }}', {
                method : 'POST',
                body : JSON.stringify(this.state)
            })
            this.setState(initialState);
        }
        render() {
            return (
                <form onSubmit={this.handleSubmit}>
                    <label>
                        Pre Tax Amount<br/>
                        <input name="preTaxAmount" title="preTaxAmount" type="number" step="0.01" min=".01" onChange={this.handleChange} value={this.state.preTaxAmount} /><br/>
                    </label>
                    <label>
                        Tax Amount<br/>
                        <input name="taxAmount" title="taxAmount" type="number" step="0.01" min=".01" onChange={this.handleChange} value={this.state.taxAmount} /><br/>
                    </label>
                    <label>
                        Transaction Type<br/>
                        <select name="transactionType" title="transactionType" onChange={this.handleChange} value={this.state.transactionType} >
                            <option disabled selected value=''></option>
                            <option value="withdrawal">Withdrawal</option>
                            <option value="deposit">Deposit</option>
                        </select><br/>
                    </label>
                    <label>
                        Sale ID<br/>
                        <input name="salesID" title="salesID" type="number" min="1" onChange={this.handleChange} value={this.state.salesID} /><br/>
                    </label>
                    <input type="submit" value="submit"/>
                </form>
            )
        }
    }
    React.render(
        React.createElement(SaleForm),
        document.getElementById('content')
    );
{% endblock %}
